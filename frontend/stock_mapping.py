# Taiwan Stock Symbol to Name Mapping
# 台股代號對應表

STOCK_MAPPING = {
    # 台灣50成分股 (Taiwan 50 Components)
    "2330": "台積電",
    "2317": "鴻海",
    "2454": "聯發科",
    "2412": "中華電",
    "2882": "國泰金",
    "2308": "台達電",
    "2881": "富邦金",
    "2886": "兆豐金",
    "2891": "中信金",
    "2303": "聯電",
    "1303": "南亞",
    "1301": "台塑",
    "2002": "中鋼",
    "2884": "玉山金",
    "2892": "第一金",
    "2912": "統一超",
    "2207": "和泰車",
    "2382": "廣達",
    "3711": "日月光投控",
    "2357": "華碩",
    "2395": "研華",
    "2408": "南亞科",
    "3008": "大立光",
    "2301": "光寶科",
    "2379": "瑞昱",
    "2603": "長榮",
    "2609": "陽明",
    "2615": "萬海",
    "5880": "合庫金",
    "2887": "台新金",
    "2890": "永豐金",
    "2880": "華南金",
    "2885": "元大金",
    "2883": "開發金",
    "5876": "上海商銀",
    "2888": "新光金",
    "2345": "智邦",
    "3045": "台灣大",
    "4904": "遠傳",
    "2327": "國巨",
    "6505": "台塑化",
    "1326": "台化",
    "2801": "彰銀",
    "2823": "中壽",
    "2834": "臺企銀",
    "2845": "遠東銀",
    "2409": "友達",
    "2474": "可成",
    "3034": "聯詠",
    "6669": "緯穎",
    
    # 其他熱門股票
    "2324": "仁寶",
    "2356": "英業達",
    "2377": "微星",
    "2376": "技嘉",
    "2353": "宏碁",
    "2354": "鴻準",
    "2347": "聯強",
    "2360": "致茂",
    "2371": "大同",
    "2449": "京元電子",
    "2451": "創見",
    "2458": "義隆",
    "2492": "華新科",
    "2498": "宏達電",
    "3037": "欣興",
    "3231": "緯創",
    "3443": "創意",
    "3481": "群創",
    "3661": "世芯-KY",
    "4938": "和碩",
    "5269": "祥碩",
    "6415": "矽力-KY",
    "6446": "藥華藥",
    "6531": "愛普",
    "6770": "力積電",
    "8046": "南電",
    
    # 金融股
    "2809": "京城銀",
    "2812": "台中銀",
    "2816": "旺旺保",
    "2820": "華票",
    "2832": "台產",
    "2836": "高雄銀",
    "2838": "聯邦銀",
    "2849": "安泰銀",
    "2850": "新產",
    "2851": "中再保",
    "2852": "第一保",
    "2855": "統一證",
    "2867": "三商壽",
    "2889": "國票金",
    "5820": "日盛金",
    "9904": "寶成",
    "9910": "豐泰",
    "9921": "巨大",
    "9933": "中鼎",
    "9945": "潤泰新",
    
    # 電子股
    "2313": "華通",
    "2323": "中環",
    "2337": "光磊",
    "2342": "茂矽",
    "2351": "順達科",
    "2352": "佳世達",
    "2362": "藍天",
    "2367": "燿華",
    "2368": "金像電",
    "2369": "菱生",
    "2373": "震旦行",
    "2375": "智寶",
    "2380": "虹光",
    "2383": "台光電",
    "2385": "群光",
    "2388": "威盛",
    "2390": "云辰",
    "2393": "億光",
    "2404": "漢唐",
    "2406": "國碩",
    "2413": "環科",
    "2414": "精技",
    "2415": "錩新",
    "2419": "仲琦",
    "2420": "新巨",
    "2421": "建準",
    "2423": "固緯",
    "2424": "隴華",
    "2425": "承啟",
    "2426": "鼎元",
    "2427": "三商電",
    "2428": "興勤",
    "2429": "銘旺科",
    "2430": "燦坤",
    "2431": "聯昌",
    "2433": "互盛電",
    "2434": "統懋",
    "2436": "偉詮電",
    "2438": "翔耀",
    "2439": "美律",
    "2440": "太空梭",
    "2441": "超豐",
    "2442": "新美齊",
    "2443": "新利虹",
    "2444": "兆勁",
    "2448": "晶電",
    "2453": "凌群",
    "2455": "全新",
    "2456": "奇力新",
    "2457": "飛宏",
    "2459": "敦吉",
    "2460": "建通",
    "2461": "光群雷",
    "2462": "良得電",
    "2464": "盟立",
    "2465": "麗臺",
    "2466": "冠西電",
    "2467": "志聖",
    "2468": "華經",
    "2471": "資通",
    "2472": "立隆電",
    "2476": "鉅祥",
    "2477": "美隆電",
    "2478": "大毅",
    "2480": "敦陽科",
    "2481": "強茂",
    "2482": "連宇",
    "2483": "百容",
    "2484": "希華",
    "2485": "兆赫",
    "2486": "一詮",
    "2488": "漢平",
    "2489": "瑞軒",
    "2491": "吉祥全",
    "2493": "揚博",
    "2495": "普安",
    "2496": "卓越",
    "2497": "怡利電",
    "2499": "東貝",
}

# 建立反向對應表 (名稱 -> 代號)
NAME_TO_SYMBOL = {name: symbol for symbol, name in STOCK_MAPPING.items()}

def get_stock_name(stock_id: str) -> str:
    """
    根據股票代號取得股票名稱
    
    Args:
        stock_id: 股票代號 (例如: "2330")
        
    Returns:
        股票名稱，如果找不到則返回空字串
    """
    return STOCK_MAPPING.get(stock_id, "")

def get_stock_symbol(stock_name: str) -> str:
    """
    根據股票名稱取得股票代號
    
    Args:
        stock_name: 股票名稱 (例如: "台積電")
        
    Returns:
        股票代號，如果找不到則返回空字串
    """
    return NAME_TO_SYMBOL.get(stock_name, "")

def get_stock_display_name(stock_id: str) -> str:
    """
    取得股票的完整顯示名稱 (代號 + 名稱)
    
    Args:
        stock_id: 股票代號 (例如: "2330")
        
    Returns:
        完整顯示名稱 (例如: "2330 台積電")
    """
    name = STOCK_MAPPING.get(stock_id)
    if name:
        return f"{stock_id} {name}"
    return stock_id

def search_stock(query: str) -> list:
    """
    搜尋股票 (支援代號或名稱的部分匹配)
    
    Args:
        query: 搜尋關鍵字
        
    Returns:
        符合的股票列表 [(代號, 名稱), ...]
    """
    query = query.strip()
    if not query:
        return []
    
    results = []
    
    # 搜尋代號
    for symbol, name in STOCK_MAPPING.items():
        if query in symbol or query in name:
            results.append((symbol, name))
    
    return results[:20]  # 限制最多20筆結果

def get_all_stocks() -> list:
    """
    取得所有股票列表
    
    Returns:
        所有股票列表 [(代號, 名稱), ...]，按代號排序
    """
    return sorted([(symbol, name) for symbol, name in STOCK_MAPPING.items()])
